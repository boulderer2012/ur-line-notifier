# URライン通知者

![Check and Ping](https://github.com/boulderer2012/ur-line-notifier/actions/workflows/check-and-ping.yml/badge.svg)

UR都市機構の新築賃貸住宅情報を定期的にチェックし、**LINEグループに新着や更新情報を通知するツール**です。  
GitHub Actions を使って自動実行され、Renderなどの外部サービスと連携することも可能です。

---

## 🧭 スクリプトの構成

現在は **`ur_checker.py` のみを使用**しています。  
以前は `check_ur.py`（静的HTML解析）も併用していましたが、現在は削除され、**動的ページ対応の `ur_checker.py` に一本化**されています。

| 📝 スクリプト名     | 🔍 特徴                                             | 🛠 使用技術                 | ⚙️ 実行環境               | 📲 通知先       |
|--------------------|--------------------------------------------------|----------------------------|--------------------------|----------------|
| `ur_checker.py`    | 動的ページ対応。抽選・関東ボタンを自動クリックして情報取得 | Selenium + BeautifulSoup  | GitHub Actionsで毎日実行 | LINEグループ   |

---

## 📌 差分検出と通知の仕様

- 前回の取得結果は **`previous.json` に保存**されます。  
- 次回実行時に **タイトル＋URLのペアで差分を検出**し、**新着物件のみをLINEグループに通知**します。
- `previous.json` が空（初回実行や手動リセット時）の場合は、**通知せずに保存のみを行い、誤通知を防止**します。

---

## 📄 `ur_checker.py` について

`ur_checker.py` は、Selenium を使って UR都市機構の新築賃貸住宅ページをブラウザ操作し、  
「抽選」や「関東」などのフィルターを**自動でクリックして、より詳細な物件情報を取得・通知**するスクリプトです。

### ✨ 特徴

- ✅ **JavaScriptで動的に生成される情報にも対応**（Selenium使用）
- ✅ **「＃抽選」「＃関東」ボタンを自動クリック**して対象物件を抽出
- ✅ **タイトル＋URLのペアで差分を検出し、LINEグループに通知**
- ✅ **初回実行時は通知せず保存のみ行うことで誤爆を防止**
- 🔐 通知先やトークンは環境変数で管理（`LINE_CHANNEL_ACCESS_TOKEN`, `LINE_GROUP_ID`）

---

## 🔐 環境変数の設定（`.env` ファイル）

このスクリプトでは、**LINE通知に必要な情報を `.env` ファイルで管理**しています。  
セキュリティのため、`.env` は `.gitignore` に追加されており、**GitHubにはアップロードされません**。

### 📄 `.env` の作成方法

1. プロジェクトルートに `.env` ファイルを作成します（`.env.example` をコピーして使うと便利です）  
2. 以下のように記述します：

```env
LINE_CHANNEL_ACCESS_TOKEN=あなたのLINEチャネルアクセストークン
LINE_GROUP_ID=通知を送りたいグループのID
※ .env.example にテンプレートがあります。必要に応じてコピーしてご利用ください。

---

## 🚀 実行方法

このスクリプトは **GitHub Actions により毎日自動で実行**されます。  
手動で実行する場合は、以下のコマンドを使用してください：

```bash
python ur_checker.py
